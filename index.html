<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro TV</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #333;
            color: #fff;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            width: 100%;
        }

        .video-section {
            flex: 1;
            height: 100%;
            position: relative;
            background-color: black;
            overflow: hidden;
            border-radius: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .video-section video {
            width: 90%;
            height: 75%;
            object-fit: contain;
            position: relative;
            z-index: 1;
        }

        .tv-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./assets/images/tvclean.webp') no-repeat center center;
            background-size: cover;
            z-index: 2;
        }

        .button-panel {
            position: absolute;
            top: 10%;
            right: 10%;
            z-index: 3;
            display: grid;
            grid-template-columns: repeat(2, 60px) 120px;
            grid-gap: 10px;
            justify-items: center;
            align-items: center;
        }

        .button {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1rem;
            color: #fff;
            cursor: pointer;
            backdrop-filter: blur(5px);
        }

        .button.power, .button.indicator {
            width: 120px;
            height: 120px;
        }

        .button.indicator {
            background: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Video Section -->
        <div class="video-section">
            <video id="video-player" controls autoplay loop></video>
            <div class="tv-overlay"></div>
            <div class="button-panel">
                <button class="button" id="menu">Menu</button>
                <button class="button" id="vol-down">Vol -</button>
                <button class="button" id="vol-up">Vol +</button>
                <button class="button" id="ch-down">Ch -</button>
                <button class="button" id="ch-up">Ch +</button>
                <div class="button indicator" id="indicator"></div>
                <button class="button power" id="power">Power</button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- TV Guide -->
            <div class="tv-guide">
                <h2>TV Guide</h2>
                <ul id="tv-guide-list"></ul>
            </div>

            <!-- Poster Container -->
            <div class="poster-container" id="poster-container"></div>
        </div>
    </div>

    <script src="./channels.js"></script>
    <script>
        const videoPlayer = document.getElementById('video-player');
        const tvGuideList = document.getElementById('tv-guide-list');
        const posterContainer = document.getElementById('poster-container');
        const powerButton = document.getElementById('power');
        const indicator = document.getElementById('indicator');
        let isPoweredOn = true;

        // Create blocks based on subcategories and randomize schedule
        function createSchedule() {
            const blocks = {};
            channels.forEach(channel => {
                if (!blocks[channel.subcategory]) {
                    blocks[channel.subcategory] = [];
                }
                blocks[channel.subcategory].push(channel);
            });

            const schedule = [];
            Object.keys(blocks).forEach(subcategory => {
                const shuffled = blocks[subcategory]
                    .sort(() => Math.random() - 0.5)
                    .map(channel => ({
                        name: channel.name,
                        description: channel.description,
                    }));
                schedule.push(...shuffled);
            });

            return schedule;
        }

        function updateTVGuide() {
            const schedule = createSchedule();
            tvGuideList.innerHTML = '';

            schedule.forEach((item, index) => {
                const guideItem = document.createElement('li');
                guideItem.textContent = `${8 + Math.floor(index / 2)}:${index % 2 === 0 ? '00' : '30'} AM - ${item.name} - ${item.description}`;
                tvGuideList.appendChild(guideItem);
            });
        }

        channels.forEach(channel => {
            // Add to Poster Container
            const poster = document.createElement('img');
            poster.src = channel.poster;
            poster.alt = channel.name;
            poster.onclick = () => {
                videoPlayer.src = channel.video;
                videoPlayer.play();
            };
            posterContainer.appendChild(poster);
        });

        if (channels.length > 0) {
            videoPlayer.src = channels[0].video;
        }

        updateTVGuide();

        // Button Functionality
        powerButton.addEventListener('click', () => {
            isPoweredOn = !isPoweredOn;
            indicator.style.background = isPoweredOn ? 'red' : 'gray';
            videoPlayer.style.display = isPoweredOn ? 'block' : 'none';
        });

        document.getElementById('vol-down').addEventListener('click', () => {
            videoPlayer.volume = Math.max(0, videoPlayer.volume - 0.1);
        });

        document.getElementById('vol-up').addEventListener('click', () => {
            videoPlayer.volume = Math.min(1, videoPlayer.volume + 0.1);
        });

        let currentChannelIndex = 0;

        document.getElementById('ch-down').addEventListener('click', () => {
            currentChannelIndex = (currentChannelIndex - 1 + channels.length) % channels.length;
            videoPlayer.src = channels[currentChannelIndex].video;
            videoPlayer.play();
        });

        document.getElementById('ch-up').addEventListener('click', () => {
            currentChannelIndex = (currentChannelIndex + 1) % channels.length;
            videoPlayer.src = channels[currentChannelIndex].video;
            videoPlayer.play();
        });
    </script>
</body>
</html>
